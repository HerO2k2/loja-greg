<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>MERCADO CLANDESTINO ‚Äî Fornecedor Gregory Walton</title>

<link href="https://fonts.googleapis.com/css2?family=VT323&display=swap" rel="stylesheet">

<style>
body{
    background: radial-gradient(circle at top, #3b2a1a 0%, #1b120a 60%, #0e0a06 100%);
    color:#e6dcc6;
    font-family:'VT323', monospace;
    margin:20px;
    font-size:20px;
}

h1,h2{
    color:#d6b98c;
    border-bottom:2px solid #6b5238;
    text-shadow:2px 2px 3px #000;
}

.section{
    margin-bottom:30px;
    background: linear-gradient(135deg, #2a1c12, #1c130c);
    padding:15px;
    border:2px solid #4b3825;
    box-shadow: inset 0 0 20px rgba(0,0,0,0.7), 0 5px 15px rgba(0,0,0,0.8);
}

.item{
    border-bottom:1px dashed #6b5238;
    padding:8px 0;
}

.item span.qty-box{
    color:#4bff4b;
    font-weight:bold;
    margin-left:5px;
    width:50px;
}

button{
    background: linear-gradient(#3a2a1a, #2a1c12);
    color:#f0e6d2;
    border:2px solid #6b5238;
    padding:4px 10px;
    cursor:pointer;
    font-family:'VT323', monospace;
    font-size:18px;
    margin-top:5px;
}
button:hover{
    background: linear-gradient(#5a3e25, #3a2a1a);
}

input[type="number"]{
    background:#1c140c;
    color:#4bff4b;
    border:2px solid #6b5238;
    padding:4px;
    font-family:'VT323', monospace;
    font-size:18px;
    width:50px;
}

.money-box{
    background: linear-gradient(135deg, #24180f, #16100a);
    padding:12px;
    border:2px solid #6b5238;
    margin-bottom:20px;
    box-shadow:0 0 15px rgba(0,0,0,0.8);
}

.log{
    background: linear-gradient(#140e08, #0c0805);
    border:2px solid #3a2a1a;
    padding:10px;
    max-height:220px;
    overflow-y:auto;
    font-size:18px;
}

.small{
    font-size:16px;
    color:#b9a57a;
}

.volume-box{
    margin-top:8px;
    font-size:18px;
}

input[type="range"]{
    width:120px;
}

#cart{
    background: linear-gradient(135deg,#1c140c,#100c08);
    border:2px solid #6b5238;
    padding:10px;
    margin-bottom:20px;
    max-height:300px;
    overflow-y:auto;
}

.cart-item{
    display:flex;
    justify-content:space-between;
    align-items:center;
    border-bottom:1px dashed #6b5238;
    padding:4px 0;
}
.cart-total{
    text-align:right;
    font-weight:bold;
    margin-top:10px;
}
</style>
</head>

<body>

<h1>‚ò† MERCADO CLANDESTINO ‚Äî FORNECEDOR Gregory Walton</h1>
<p class="small">Loja virtual ‚Ä¢ Compra e venda sob risco do comprador</p>

<div class="money-box">
üí∞ Dinheiro dispon√≠vel: $
<input type="number" id="money">
<div class="volume-box">
üîä Volume:
<input type="range" id="volume" min="0" max="1" step="0.01" value="0.6">
</div>
</div>

<div id="store"></div>

<h2>üõí Carrinho de Compras</h2>
<div id="cart"></div>
<button onclick="finalizarCompra()">Finalizar Compra</button>

<h2>üìú Registro de Transa√ß√µes</h2>
<div class="log" id="log"></div>

<audio id="sndBuy" src="sons/comprar.mp3"></audio>
<audio id="sndSell" src="sons/vender.mp3"></audio>
<audio id="sndError" src="sons/erro.mp3"></audio>

<script>
const moneyInput = document.getElementById("money");
const logBox = document.getElementById("log");
const volumeControl = document.getElementById("volume");
const sndBuy = document.getElementById("sndBuy");
const sndSell = document.getElementById("sndSell");
const sndError = document.getElementById("sndError");

const storeDiv = document.getElementById("store");
const cartDiv = document.getElementById("cart");
let cart = {}; // carrinho interno

/* ===== LOCAL STORAGE ===== */
moneyInput.value = localStorage.getItem("skull_money") || 1000;

/* ===== VOLUME ===== */
[sndBuy, sndSell, sndError].forEach(s => s.volume = volumeControl.value);
volumeControl.addEventListener("input", ()=> {
    [sndBuy, sndSell, sndError].forEach(s => s.volume = volumeControl.value);
});

/* ===== FUN√á√ïES ===== */
function play(sound){
    sound.currentTime = 0;
    sound.play();
}

function log(msg){
    logBox.innerHTML = msg + "<br>" + logBox.innerHTML;
}

/* ===== LOJA ===== */
const categories = [
{
title:"ARMAS ‚Äî CURTO ALCANCE",
items:[
["Soco Ingl√™s",40,"1d6 + LUTA","Impacto"],
["Luvas com Refor√ßo",40,"1d6 + LUTA","Impacto"],
["Faca de Cozinha",40,"1d6 + CORTE","Corte"],
["Faca Militar",60,"1d8 + CORTE","Corte"],
["Estilete",40,"1d6 + CORTE","Corte"],
["Bisturi",40,"1d6 + CORTE","Corte"],
["Canivete",40,"1d6 + CORTE","Corte"],
["Chave de Fenda",40,"1d6 + Corte", "Corte"],
["Tesoura",40,"1d6 + CORTE","Perfura√ß√£o"],
["Furador de Gelo",40,"1d6 + CORTE","Perfura√ß√£o"],
["Agulha grossa",40,"1d6 + CORTE", "Perfura√ß√£o"],
["Martelo Pequeno",60,"1d8 + LUTA","Impacto"],
["Martelo de Demoli√ß√£o",100,"1d10 + LUTA","Impacto"],
["Porrete de Madeira",60,"1d8 + LUTA","Impacto"],
["Taco de Beisebol",100,"1d10 + LUTA","Impacto"],
["Fac√£o de Mato",75,"2d4 + CORTE","Corte"],
["Machete",75,"1d8 + CORTE","Corte"],
["Bast√£o Retr√°til",100,"1d8 + LUTA","Impacto"],
["Bast√£o Taser",160,"1d6 + 1d4 + LUTA","Impacto + Queimadura"],
["Tocha Improvisada",30,"1d6 + SOBREVIV√äNCIA","Queimadura"],
["Adaga Ritual",100,"1d8 + OCULTISMO","Ocultismo"],
["Ros√°rio Pontiagudo",40,"1d6 + OCULTISMO","Ocultismo"],
["Cruz de Madeira",35,"1d6 + OCULTISMO","Ocultismo"]
]
},

{
title:"ARMAS ‚Äî M√âDIO ALCANCE",
items:[
["P√© de Cabra",80,"1d8 + LUTA","Impacto"],
["Cassetete Policial",120,"2d6 + LUTA","Impacto"],
["Sabre",110,"1d10 + CORTE","Corte"],
["Espada Curta",130,"2d6 + CORTE","Corte"],
["Katana",300,"2d8 + CORTE","Corte"],
["Lan√ßa",160,"2d6 + CORTE","Perfura√ß√£o"],
["Alabarda",425,"2d6 + 1d4 + CORTE","Corte + Perfura√ß√£o"],
["Machado T√°tico",280,"2d8 + CORTE","Corte"],
["Foice Improvisada",80,"1d8 + CORTE", "Corte"],
["Espeto Met√°lico",80,"1d8 + CORTE", "Perfura√ß√£o"],
["Tridente",180,"2d6 + CORTE","Perfura√ß√£o"],
["Espada Ritual",1200,"2d6 + 1d4 + CORTE + OCULTISMO","Ocultismo"],
["Lan√ßa Cerimonial",1000,"1d8 + 1d4 + CORTE + RITUAL", "Corte + Ritual"]
]
},

{
title:"ARMAS ‚Äî LONGO ALCANCE",
items:[
["Arco Tradicional",180,"1d8 + SOBREVIV√äNCIA","Perfura√ß√£o"],
["Arco Composto",400,"2d8 + SOBREVIV√äNCIA","Perfura√ß√£o"],
["Besta Leve",200,"1d10 + SOBREVIV√äNCIA","Perfura√ß√£o"],
["Besta de Alta Press√£o",1600,"2d10 + 1d6 + SOBREVIV√äNCIA","Perfura√ß√£o"],
["Pistola 9mm",200,"1d8 + T√ÅTICA","Perfura√ß√£o"],
["Revolver",180,"2d4 + T√ÅTICA","Perfura√ß√£o"],
["Revolver Colt D",300,"2d6 + T√ÅTICA","Perfura√ß√£o"],
["Magnum .44",1800,"3d6 + T√ÅTICA","Perfura√ß√£o"],
["SMG (9mm)",3200,"2d10 + T√ÅTICA","Perfura√ß√£o"],
["Rifle de Assalto (5.56mm)",4000,"3d8 + T√ÅTICA","Perfura√ß√£o"],
["Rifle de Ca√ßa (.308)",2500,"2d12 + SOBREVIV√äNCIA","Perfura√ß√£o"],
["Rifle de Precis√£o (.338)",6500,"4d10 + T√ÅTICA","Perfura√ß√£o"],
["Escopeta T√°tica",3500,"3d8 + T√ÅTICA","Perfura√ß√£o"],
["Escopeta de Cano Duplo",700,"2d8 + SOBREVIV√äNCIA","Perfura√ß√£o"],
["Espingarda de Repeti√ß√£o",1200,"2d10 + SOBREVIV√äNCIA","Perfura√ß√£o"],
["Bazooka",10000,"8d10","Queimadura"]
]
},

{
title:"ARREMESS√ÅVEIS",
items:[
["Prego",2,"1d4","Perfura√ß√£o"],
["Kunai",20,"1d6","Perfura√ß√£o"],
["Shuriken",20,"1d6","Corte"],
["Bola de T√™nis",5,"1d4","Impacto"],
["Granada Explosiva",2000,"4d10","Queimadura"],
["Granada de Fuma√ßa",300,"N√©voa por 2 turnos","cega por 2 turnos (vis√£o -2)"],
["Granada de Luz",400,"1d8","cega por um turno (resist√≠vel)"],
["Granda de Som",40,"1d6","Impacto + 50% de dano em certas criaturas"]
]
},

{
title:"ARMADURAS & PROTE√á√ïES",
items:[
["Armadura de Metal",150,"Corte +1","Prote√ß√£o"],
["Armadura de Couro",100,"Impacto +1","Prote√ß√£o"],
["Colete Leve",200,"Perfura√ß√£o +1","Prote√ß√£o"],
["Colete Pesado",800,"Perfura√ß√£o +4","Prote√ß√£o"],
["Colete SWAT",1300,"Perfura√ß√£o +4, +5 PV","Prote√ß√£o"],
["Colete Militar Especial",2200,"Perfura√ß√£o +6, +10 PV","Prote√ß√£o"],
["Capacete Bal√≠stico",300,"Perfura√ß√£o +1, +1 PV","Prote√ß√£o"],
["Bra√ßadeira Militar Esp.",750,"Corte +3, Impacto +3","Prote√ß√£o"],
["Bra√ßadeira T√°tica Leve",300,"Impacto +2","Prote√ß√£o"],
["Grevas de A√ßo",300,"Corte +2","Prote√ß√£o"],
["M√°scara Anti-Ritual",600,"Ritual +3","Prote√ß√£o"],
["Amuleto de Prote√ß√£o",500,"Ocultismo +2","Prote√ß√£o"],
["T√∫nica de Exorcismo",700,"Ocultismo +3, Ritual +1","Prote√ß√£o"],
["Escudo Improvisado",100,"Impacto +2","Prote√ß√£o, bloqueio manual"],
["Botas de Combate",200,"Atletismo +1, Impacto +1","Prote√ß√£o"],
["Roupa Resistente a Fogo",1000,"Queimadura +4","Prote√ß√£o"],
["Casaco de Couro Grosso",250,"Impacto +2","Prote√ß√£o"]
]
},

{
title:"ITENS UTILIT√ÅRIOS",
items:[
["Algema",100,"Restringe alvo","uso fora de combate"],
["Atadura",25,"Cura 1d4","cura no turno seguinte e usa todas as a√ß√µes"],
["Kit M√©dico",300,"Cura 1d20","1 uso por combate, 2 turnos para curar, usa todas as a√ß√µes"],
["Kit Arrombamento",200,"3 gazuas, vantagem em FURTIVIDADE","apenas fechaduras"],
["Kit Tirolesa",250,"Teste de ATLETISMO ou ACROBACIA","1 uso por √°rea"],
["Kit Acampamento",100,"Itens para acampar","Utilit√°rio"],
["Kit Engenheiro",220,"Ferramentas, fios, etc","√ötil para Engenheiros"],
["Desfibrilador Port√°til",500,"Revive aliado","cura"],
["Notebook",300,"Pesquisa e dados","utilit√°rio"],
["Lanterna",30,"Ilumina√ß√£o","ilumina √°reas escuras ou subterr√¢neas"],
["R√°dio Comunicador",150,"Comunica√ß√£o global","utilit√°rio"],
["Jaleco de Laborat√≥rio",15,"Estilo","Decorativo"],
["Caderno com Caneta",10,"Registrar informa√ß√µes","utilit√°rio"],
["√ìculos",120,"PERCEP√á√ÉO +1","utilit√°rio"],
["Mapa: EUA",100,"Mostra as √°reas permitidas nos EUA","utilit√°rio"],
["Mapa: Mundi",500,"Mostra as √°reas permitidas no Mundo","utilit√°rio"],
["√Ågua Benta (m√°x - 3)",5,"os efeitos variam","√∫til contra certas criaturas"],
["Alho (m√°x - 3)",1,"bom tempero","√∫til contra certas criaturas"],
["Comida",10,"Recupera 1d6","uso fora de combate"]
]
},

{
title:"MUNI√á√ïES",
items:[
["Flecha (1)",10,"Perfura√ß√£o","Muni√ß√£o R√∫stica"],
["Virola (1)",15,"Perfura√ß√£o","Muni√ß√£o R√∫stica"],
["9mm (6)",15,"Perfura√ß√£o","Muni√ß√£o"],
[".44 Magnum (6)",30,"Perfura√ß√£o","Muni√ß√£o"],
["Chumbo (2)",45, "Perfura√ß√£o","Muni√ß√£o"],
[".308 Rifle de ca√ßa (4)",250, "Perfura√ß√£o","Muni√ß√£o"],
[".338 Rifle de Assalto (30)",500, "Perfura√ß√£o","Muni√ß√£o"],
["5.56mm (30)",500,"Perfura√ß√£o","Muni√ß√£o"],
["Balas Flamejantes (2)",100,"+6 fogo","Dano de Queimadura"],
["Balas Criog√™nicas (2)",125,"-2 dano base","1d20 Chance de congelar"],
["Balas de Prata - Igreja (1)",200,"dano aumentado contra certas criaturas","Especial"]
]
}
];

/* Renderiza Loja */
categories.forEach(cat=>{
    let html = `<div class="section"><h2>${cat.title}</h2>`;
    cat.items.forEach(i=>{
        const key = i[0].replace(/\s/g,"_");
        html += `
        <div class="item">
        <b>${i[0]}</b> ‚Äî $${i[1]} | ${i[2]} | ${i[3]}
        <input type="number" class="qty-box" id="qty_${key}" value="0" min="0">
        <div>
        <button onclick="adicionarCarrinho('${key}',${i[1]},'${i[0]}')">Adicionar ao Carrinho</button>
        <button onclick="venderItem('${key}',${i[1]},'${i[0]}')">Vender</button>
        </div>
        </div>`;
        // Inicializa quantidade no localStorage se n√£o existir
        if(localStorage.getItem(key)===null) localStorage.setItem(key,0);
        document.addEventListener("DOMContentLoaded", ()=> {
            document.getElementById(`qty_${key}`).value = localStorage.getItem(key);
        });
    });
    html += "</div>";
    storeDiv.innerHTML += html;
});

/* ===== CARRINHO ===== */
function adicionarCarrinho(key,price,name){
    if(!cart[key]) cart[key] = {price: price, name:name, amount:0};
    cart[key].amount += 1;
    renderCarrinho();
}

function renderCarrinho(){
    cartDiv.innerHTML = "";
    let total = 0;
    for(let k in cart){
        let item = cart[k];
        total += item.price * item.amount;
        cartDiv.innerHTML += `
        <div class="cart-item">
        ${item.name} x ${item.amount} ‚Äî $${item.price} cada
        <button onclick="removerCarrinho('${k}')">Remover</button>
        </div>`;
    }
    cartDiv.innerHTML += `<div class="cart-total">Total: $${total}</div>`;
}

function removerCarrinho(key){
    if(cart[key]){
        cart[key].amount -=1;
        if(cart[key].amount <=0) delete cart[key];
        renderCarrinho();
    }
}

/* ===== FINALIZAR COMPRA ===== */
function finalizarCompra(){
    let total = 0;
    for(let k in cart){
        total += cart[k].price * cart[k].amount;
    }
    let dinheiro = Number(moneyInput.value);
    if(total>dinheiro){
        play(sndError);
        log(`‚ùå Fundos insuficientes para finalizar a compra! Total: $${total}`);
        return;
    }
    // Deduz dinheiro
    dinheiro -= total;
    moneyInput.value = dinheiro;
    localStorage.setItem("skull_money", dinheiro);
    // Atualiza quantidade de cada item comprado
    for(let k in cart){
        let inputEl = document.getElementById(`qty_${k}`);
        let atual = Number(inputEl.value) || 0;
        inputEl.value = atual + cart[k].amount;
        localStorage.setItem(k, inputEl.value);
        log(`‚úî Comprado: ${cart[k].name} x ${cart[k].amount} (-$${cart[k].price*cart[k].amount})`);
    }
    cart = {}; // esvazia carrinho
    renderCarrinho();
    play(sndBuy);
}

/* ===== VENDER ===== */
function venderItem(key,price,name){
    let inputEl = document.getElementById(`qty_${key}`);
    let qtd = Number(inputEl.value) || 0;
    if(qtd<=0){
        play(sndError);
        log(`‚ùå ${name} voc√™ n√£o possui esse item.`);
        return;
    }
    inputEl.value = qtd-1;
    localStorage.setItem(key, inputEl.value);
    let ganho = Math.floor(price*0.3);
    let dinheiro = Number(moneyInput.value) + ganho;
    moneyInput.value = dinheiro;
    localStorage.setItem("skull_money", dinheiro);
    log(`‚Ü© Vendido: ${name} (+$${ganho})`);
    play(sndSell);
}
</script>

</body>
</html>
